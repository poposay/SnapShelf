<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>сЃЮсЃЮсѓбсЃФсЃљсЃа№╝ѕС╗«тљЇ№╝Ѕ</title>
<link rel="stylesheet" href="/css/style.css">
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic&display=swap" rel="stylesheet">
</head>
<body class="popo-register">
	<div class="popo-container">
		<img src="/images/popo-back.png" alt="сЃЮсЃЮсЂ«тЙїсѓЇтД┐" class="popo-back"/>
		<div class="popo-bubble">
		<h1>сЂѓсЂфсЂЪсЂ«сЂЊсЂесѓњТЋЎсЂѕсЂдсЂЈсЂасЂЋсЂё</h1>
		</div>
		<form th:action="@{/register}" method="post" id="registerForm">
			<label for="username">сЃІсЃЃсѓ»сЃЇсЃ╝сЃа</label>
			<input type="text" id="username" name="username" required autocomplete="off">
			
			<label for="email">сЃАсЃ╝сЃФсѓбсЃЅсЃгсѓ╣</label>
			<input type="email" id="email" name="email" required autocomplete="off">
			
			<label for="password">сЃЉсѓ╣сЃ»сЃ╝сЃЅ</label>
			<input type="password" id="password" name="password" required autocomplete="off">
			
			<button type="submit">сЃЮсЃЮсЂФС╝џсЂёсЂФУАїсЂЈ</button>
		</form>
	</div>
	
	<script>
		document.getElementById("registerForm").addEventListener("submit", function(event) {
		  event.preventDefault(); // сЃЋсѓЕсЃ╝сЃажђЂС┐АтЂюТГб

		  const data = {
		    username: document.getElementById("username").value,
		    email: document.getElementById("email").value,
		    password: document.getElementById("password").value
		  };

		  fetch("/api/register", {
		    method: "POST",
		    headers: {
		      "Content-Type": "application/json"
		    },
		    body: JSON.stringify(data)
		  })
		  .then(response => {
		    return response.text().then(text => {
		      if (!response.ok) {
		        alert("уЎ╗жї▓сѓесЃЕсЃ╝: " + text); // Рџа№ИЈ сѓесЃЕсЃ╝ТЎѓсѓбсЃЕсЃ╝сЃѕсЂасЂЉ
		        throw new Error(); // ­Ъћљ С╗ЦжЎЇсЂ«тЄдуљєсѓњТГбсѓЂсѓІ
		      }
		      alert(text); // ­ЪјЅ ТѕљтіЪсЃАсЃЃсѓ╗сЃ╝сѓИ
		      sessionStorage.setItem("username", data.username); // тљЇтЅЇсѓњТИАсЂЎ
		      window.location.href = "/welcome"; // ­Ъјѕ ТѕљтіЪТЎѓсЂ«сЂ┐жЂиуД╗№╝Ђ
		    });
		  })
		  .catch(error => {
		    if (error.message) {
		      alert("жђџС┐АсѓесЃЕсЃ╝: " + error.message); // жђџС┐АсѓесЃЕсЃ╝уће
		    }
		  });
		});
		
	</script>
		

</body>
</html>